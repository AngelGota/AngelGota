name: 1. AutoCommit → AutoCreate feature/*

on:
  schedule:
    - cron: "*/5 * * * *"   # cada 15 min (UTC) — ajusta si quieres
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

concurrency:
  group: auto-fill-${{ github.ref }}
  cancel-in-progress: true

jobs:
  fill:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with: { fetch-depth: 0 }

      - name: Config Git
        run: |
          git config user.name  "AngelGota"
          git config user.email "gangelos630@gmail.com"

      - name: Crear rama nueva feature/* y modificar archivo
        shell: bash
        run: |
          set -euo pipefail
          TS="$(date -u +'%Y%m%d-%H%M%S')"
          BRANCH="feature/auto-fill-${TS}"
          git fetch origin main
          git checkout -B "${BRANCH}" origin/main

          mkdir -p automation/data
          DATE_UTC="$(date -u +"%Y-%m-%d %H:%M:%S UTC")"
          echo "- run: ${DATE_UTC}" >> automation/data/fill_status.md

          git add automation/data/fill_status.md
          git commit -m "chore: auto-fill ${TS}"
          git push -u origin "${BRANCH}"
